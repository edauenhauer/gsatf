var gsatf=angular.module("gsaTableFormatter",["ngRoute","xeditable"]);gsatf.controller("SimpleController",["$scope","gsatfFactory","$sce","$location",function(e,t,l,a){e.table=t.getTable(),e.tableHtml=t.buildHtml(),e.click=function(){e.table=t.extractData(e.textarea),e.tableHtml=t.buildHtml(),a.path("view2")},e.close=function(){$("#submitDataBtn").popover("hide")},e.user={name:l.trustAsHtml("eric<br>dauenhauer")}}]),gsatf.config(["$routeProvider",function(e){e.when("/",{templateUrl:"pages/view1.html",controller:"SimpleController"}).when("/view2",{templateUrl:"pages/view2.html",controller:"SimpleController"}).otherwise({redirectTo:"/"})}]);
gsatf.directive("customPopover",["$compile",function(t){return{restrict:"A",link:function(e,o,n){function c(o){var n={copyPaste:$("#copy-paste_popover_content").html(),upload:$("#upload_popover_content").html(),whichOne:$("#which-one_popover_content").html()};return t(n[o])(e)}$(o).popover({trigger:n.popoverTrigger,html:!0,content:c(n.popoverHtml),placement:n.popoverPlacement})}}}]),gsatf.directive("dynamic",["$compile","$sce",function(t,e){return{restrict:"A",replace:!0,link:function(e,o,n){e.$watch(n.dynamic,function(n){o.html(n),t(o.contents())(e)})}}}]);
gsatf.factory("gsatfFactory",function(){function t(){var t=sprintf("<tr><td id='0000' colspan='%(nCols)i' class='%(tdTitle)s %(tdAll)s %(trTitle)s'><span editable-text='table.title'>",s),e="</span></td></tr>";return t+"{{ table.title }}"+e}function e(){for(var t=/\(.*\)/,e="<tr>",r=0;r<i.headers.length;r++){var n=10>r?"010"+r.toString():"01"+r.toString();t.test(i.headers[r])&&(console.log(t),console.log(i.headers[r].match(t)[0]),console.log(i.headers[r]),i.headers[r]=i.headers[r].replace(t,"<br />"+i.headers[r].match(t)[0]),console.log(i.headers[r])),e+=sprintf("<td id='%s' class='%s %s'>",n,s.tdCenter,s.trBreak),e+=sprintf("<span editable-text='table.headers[%i]'>{{ table.headers[%i] }}</span></td>",r,r)}return e+"</tr>"}function r(){for(var t=(i.body,""),e=0;e<i.body.length;e++){i.body[e];if(t+="<tr>",e!=i.body.length-1){if(1==i.body[e].length){var r=10>e?"0"+e.toString()+"00":e.toString();t+=sprintf("<td id='%s' colspan='%s' class='%s %s'><span editable-text='table.body[%i][0]'>",r,s.nCols,s.tdSubhead,e),t+="{{ table.body["+e+"][0] }}</span></td></tr>";continue}for(var n=0;n<i.body[e].length;n++){var l=10>e?"0"+e.toString():e.toString(),a=10>n?"0"+n.toString():n.toString();t+=sprintf("<td id='%s' class='%s'><span editable-text='table.body[%i][%i]'>%s</span></td>",l+a,s.tdAll,e,n,"{{ table.body["+e+"]["+n+"] }}")}}else for(var n=0;n<i.body[e].length;n++){var l=10>e?"0"+e.toString():e.toString(),a=10>n?"0"+n.toString():n.toString();t+=sprintf("<td id='%s' class='%s %s'><span editable-text='table.body[%i][%i]'>%s</span></td>",l+a,s.tdAll,s.trBreak,e,n,"{{ table.body["+e+"]["+n+"] }}")}t+="</tr>"}return t}function n(){var t="";return t}var l={},i={title:"",headers:[],body:[],footnotes:[]},a="",s={trTitle:"trTitle",trBreak:"trBreak",tdTitle:"tdTitle",tdCenter:"tdCenter",tdSubhead:"tdSubhead",tdAll:"tdAll",nCols:0,nRows:0};return l.getTable=function(){return i},l.extractData=function(t){var e=function(t){return""!==t},r=function(t){return"#"!=t[0]&&"//"!=t.slice(0,2)};for(t=t.split(/\n/),t=t.filter(e).filter(r),n=0;n<t.length;n++)t[n]=t[n].split(/\t/),data_filter=t[n].filter(e),1==data_filter.length&&data_filter[0]==t[n][0]&&(t[n]=data_filter);s.nCols=t.slice().sort(function(t,e){return e.length-t.length})[0].length,1==t[0].length?i.title=t.shift()[0]:i.title+="Title 1.",i.headers=t.shift();for(var n=0;n<t.length;n++)i.body.push(t[n])},l.parseData=function(r){var n=r;a="<table cellspacing=0 border=0>";var l=function(t){return""!==t},o=function(t){return"#"!=t[0]&&"//"!=t.slice(0,2)};for(n=n.split(/\n/),n=n.filter(l).filter(o),d=0;d<n.length;d++)n[d]=n[d].split(/\t/),data_filter=n[d].filter(l),1==data_filter.length&&data_filter[0]==n[d][0]&&(n[d]=data_filter);s.nCols=n.slice().sort(function(t,e){return e.length-t.length})[0].length,a+=1==n[0].length?t(n.shift()[0],s):t("Title 1.",s),a+=e(n.shift(),s),n.unshift("","");for(var d=2;d<n.length;d++){var f=n[d];if(a+="<tr>",d!=n.length-1){if(1==f.length){var g=10>d?"0"+d.toString()+"00":d.toString();a+=sprintf("<td id='%s' colspan='%s' class='%s %s'>",g,s.nCols,s.tdSubhead),a+=f[0]+"</td></tr>";continue}for(var h=0;h<f.length;h++){var c=10>d?"0"+d.toString():d.toString(),b=10>h?"0"+h.toString():h.toString();a+=sprintf("<td id='%s' class='%s'>%s</td>",c+b,s.tdAll,f[h])}}else for(var h=0;h<f.length;h++){var c=10>d?"0"+d.toString():d.toString(),b=10>h?"0"+h.toString():h.toString();a+=sprintf("<td id='%s' class='%s %s'>%s</td>",c+b,s.tdAll,s.trBreak,f[h])}a+="</tr>"}return a+="</table>",i},l.buildHtml=function(){return a="<table cellspacing=0 border=0>",a+=t(),a+=e(),a+=r(),a+=n(),a+="</table>"},l});